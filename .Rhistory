g <- ggplot(secoefWB, aes(x=parameter, y=Coefficient), stat="identity")
g + geom_bar(position="dodge") + facet_wrap(~couple)
secoefWB
g + geom_bar(position="dodge") + facet_wrap(~couple)
#now with controls for educational barriers
data <- rbind(c(0.115,0.102,0.130,-0.023,0.132,0.087),
c(0.037,0.024,0.07,0.027,0.071,-0.022),
c(0.083,0.071,0.120,0.027,0.117,0.024),
c(0.101,0.086,0.110,0.064,0.119,0.068))
colnames(data) <- c("Pooled","Geometric Mean", "Same as White","Same as Non-White","Hou and Myles (W)","Hou and Myles (B)")
rownames(data) <- c("White Female Hypergamy","White Female Hypogamy","White Male Hypergamy", "White Male Hypogamy")
data <- data[,1:4]
secoefWB.wEB <- as.data.frame.table(data)
secoefWB.wEB$couple <- as.factor(rep(c("Non-White Man/White Woman","Non-White Man/White Woman","White Man/Non-White Woman", "White Man/Non-White Woman"),4))
secoefWB.wEB$parameter <- as.factor(rep(c("White Hypergamy","White Hypogamy"),8))
secoefWB.wEB$error <- c(0.021,0.023,0.023,0.023,0.021,0.021,0.023,0.025,0.022,0.022,0.024,0.024,0.024,0.024,0.025,0.026)
colnames(secoefWB.wEB)[[2]] <- "Model"
colnames(secoefWB.wEB)[[3]] <- "Coefficient"
g <- ggplot(secoefWB.wEB, aes(x=parameter, fill=Model, y=Coefficient), stat="identity")
g + geom_bar(position="dodge") + facet_wrap(~couple)
g+geom_point()
g+geom_point()+facet_wrap(~couple)
ebcoef <- NULL
ebcoef$Coefficient <- coef(ebmodel4.full)[26:73]
ebcoef$error <- summary(ebmodel4.full)$coef[26:73,2]
ebcoef$couple <- as.factor(c(rep("White/Black",16),rep("Brown/Black",16),rep("White/Brown",16)))
ebcoef <- as.data.frame(ebcoef)
ebcoef$color <- as.factor(c(rep("Darker Man",4),rep("Lighter Woman",4), rep("Lighter Man",4),rep("Darker Woman",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4)))
ebcoef$gender <- as.factor(c(rep("Male",4),rep("Female",4), rep("Male",4),rep("Female",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4)))
ebcoef$barrier <- as.factor(rep(c("Primary Grad v. Incomplete Primary", "Lower Secondary v. Primary Grad", "Upper Secondary v. Lower Secondary", "Some College v. Upper Secondary"), 12))
ebcoef$Model <- "Pooled"
temp <- NULL
temp$Coefficient <- coef(ebmodel3.full)[74:121]
temp$error <- summary(ebmodel3.full)$coef[74:121,2]
temp$couple <- as.factor(c(rep("White/Black",16),rep("Brown/Black",16),rep("White/Brown",16)))
temp <- as.data.frame(temp)
temp$color <- as.factor(c(rep("Darker Man",4),rep("Lighter Woman",4), rep("Lighter Man",4),rep("Darker Woman",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4)))
temp$gender <- as.factor(c(rep("Male",4),rep("Female",4), rep("Male",4),rep("Female",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4)))
temp$barrier <- as.factor(rep(c("Primary Grad v. Incomplete Primary", "Lower Secondary v. Primary Grad", "Upper Secondary v. Lower Secondary", "Some College v. Upper Secondary"), 12))
temp$Model <- "Geometric Mean"
ebcoef <- rbind(ebcoef, temp)
temp <- NULL
temp$Coefficient <- coef(ebmodel2.full)[74:121]
temp$error <- summary(ebmodel2.full)$coef[74:121,2]
temp$couple <- as.factor(c(rep("White/Black",16),rep("Brown/Black",16),rep("White/Brown",16)))
temp <- as.data.frame(temp)
temp$color <- as.factor(c(rep("Darker Man",4),rep("Lighter Woman",4), rep("Lighter Man",4),rep("Darker Woman",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4)))
temp$gender <- as.factor(c(rep("Male",4),rep("Female",4), rep("Male",4),rep("Female",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4)))
temp$barrier <- as.factor(rep(c("Primary Grad v. Incomplete Primary", "Lower Secondary v. Primary Grad", "Upper Secondary v. Lower Secondary", "Some College v. Upper Secondary"), 12))
temp$Model <- "Same as Lighter"
ebcoef <- rbind(ebcoef, temp)
temp <- NULL
temp$Coefficient <- coef(ebmodel1.full)[74:121]
temp$error <- summary(ebmodel1.full)$coef[74:121,2]
temp$couple <- as.factor(c(rep("White/Black",16),rep("Brown/Black",16),rep("White/Brown",16)))
temp <- as.data.frame(temp)
temp$color <- as.factor(c(rep("Darker Man",4),rep("Lighter Woman",4), rep("Lighter Man",4),rep("Darker Woman",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4)))
temp$gender <- as.factor(c(rep("Male",4),rep("Female",4), rep("Male",4),rep("Female",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4)))
temp$barrier <- as.factor(rep(c("Primary Grad v. Incomplete Primary", "Lower Secondary v. Primary Grad", "Upper Secondary v. Lower Secondary", "Some College v. Upper Secondary"), 12))
temp$Model <- "Same as Darker"
ebcoef <- rbind(ebcoef, temp)
ebcoef$barrier <- relevel(ebcoef$barrier, "Some College v. Upper Secondary")
ebcoef$barrier <- relevel(ebcoef$barrier, "Upper Secondary v. Lower Secondary")
ebcoef$barrier <- relevel(ebcoef$barrier, "Lower Secondary v. Primary Grad")
ebcoef$barrier <- relevel(ebcoef$barrier, "Primary Grad v. Incomplete Primary")
ebcoef$couple <- relevel(ebcoef$couple, "White/Brown")
ebcoef$couple <- relevel(ebcoef$couple, "White/Black")
ebcoef$Model <- as.factor(ebcoef$Model)
ebcoef$Model <- relevel(ebcoef$Model, "Pooled")
g <- ggplot(ebcoef, aes(x=barrier, fill=Model, y=Coefficient), stat="identity")
g + geom_bar(position="dodge") + facet_grid(couple~color) + scale_fill_grey() + coord_flip()+opts(legend.position = "bottom")
g + geom_bar(position="dodge") + facet_grid(couple~color) + scale_fill_grey()
g <- ggplot(ebcoef[ebcoef$Model=="Pooled",], aes(barrier, Coefficient, color=Model, ymin = Coefficient-1.96*error, ymax=Coefficient+1.96*error))
g + geom_point(size=2, position=position_dodge(width=0.5)) + geom_errorbar(width=0.1, position=position_dodge(width=0.5)) + facet_grid(couple~color)+geom_hline(aes(yintercept=0), linetype=2, colour="grey")+ scale_colour_grey()+ coord_flip()+ylab("log odds ratio of interracial marriage")+theme(panel.grid.major = element_line(colour = "NA",),panel.grid.minor = element_line(colour = NA),panel.background = element_rect(fill='white', colour = 'black'))+coord_flip()+theme(legend.position = "none")
g + geom_point(size=2, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(couple~color)+geom_hline(aes(yintercept=0), linetype=2, colour="grey") +
scale_colour_grey()+ coord_flip()+ylab("log odds ratio of interracial marriage") +
theme(panel.grid.major = element_line(colour = "NA",),panel.grid.minor = element_line(colour = NA),
panel.background = element_rect(fill='white', colour = 'black', legend.position = "none")) +
coord_flip()
g + geom_point(size=2, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(couple~color)+geom_hline(aes(yintercept=0), linetype=2, colour="grey") +
scale_colour_grey()+ coord_flip()+ylab("log odds ratio of interracial marriage") +
theme(panel.grid.major = element_line(colour = "NA",),panel.grid.minor = element_line(colour = NA),
panel.background = element_rect(fill='white', colour = 'black')) +
coord_flip()+theme(legend.position = "none")
g + geom_point(size=2, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(couple~color)+geom_hline(aes(yintercept=0), linetype=2, colour="grey") +
scale_colour_grey()+ coord_flip()+ylab("log odds ratio of interracial marriage") +
theme(panel.grid.major = element_line(colour = "NA",),panel.grid.minor = element_line(colour = NA),
panel.background = element_rect(fill='white', colour = 'black', legend.position="none")) +
coord_flip()
g + geom_point(size=2, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(couple~color)+geom_hline(aes(yintercept=0), linetype=2, colour="grey") +
scale_colour_grey()+ coord_flip()+ylab("log odds ratio of interracial marriage") +
theme(panel.grid.major = element_line(colour = "NA",),panel.grid.minor = element_line(colour = NA),
panel.background = element_rect(fill='white', colour = 'black'), legend.position="none") +
coord_flip()
g + geom_point(size=2, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(couple~color)+geom_hline(aes(yintercept=0), linetype=2, colour="grey") +
scale_colour_grey()+ coord_flip()+ylab("log odds ratio of interracial marriage") +
theme(panel.grid.major = element_line(colour = "NA"),panel.grid.minor = element_line(colour = NA),
panel.background = element_rect(fill='white', colour = 'black'), legend.position="none") +
coord_flip()
ebcoef
head(ebcoef)
mytheme <- theme(panel.grid.major = element_line(colour = "NA"),panel.grid.minor = element_line(colour = NA),
panel.background = element_rect(fill='white', colour = 'black'), legend.position="none")
g + geom_point(size=2, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(couple~color)+geom_hline(aes(yintercept=0), linetype=2, colour="grey") +
scale_colour_grey()+ coord_flip()+ylab("log odds ratio of interracial marriage") +
mytheme +
coord_flip()
lOR <- data.frame(lOR=c(-7.82, lOR.wb,lOR.wr,lOR.br),se=c(0.01,0.026,0.009,0.024),marriage=as.factor(c("USA\nWhite/Black","Brazil\nWhite/Black","Brazil\nWhite/Brown","Brazil\nBrown/Black")))
lOR$marriage <- relevel(lOR$marriage,"Brazil\nBrown/Black")
lOR$marriage <- relevel(lOR$marriage,"Brazil\nWhite/Brown")
lOR$marriage <- relevel(lOR$marriage,"Brazil\nWhite/Black")
lOR$marriage <- relevel(lOR$marriage,"USA\nWhite/Black")
lOR$OR <- exp(lOR$lOR)
lOR$OR.upper <- exp(lOR$lOR+1.96*lOR$se)
lOR$OR.lower <- exp(lOR$lOR-1.96*lOR$se)
g <- ggplot(lOR, aes(x=marriage, y=lOR), stat=identity)
g + geom_bar()+opts(panel.grid.major = theme_line(colour = "NA",),panel.grid.minor = theme_line(colour = NA),panel.background = theme_rect(colour = 'black'))
g <- ggplot(lOR, aes(x=marriage, y=OR, ymin = OR.lower, ymax=OR.upper), stat=identity)
g + geom_point(size=3)+theme(panel.grid.major = element_line(colour = "NA",),panel.grid.minor = element_line(colour = NA),panel.background = element_rect(fill='white', colour = 'black'),legend.position = "none")+ylab("odds ratio of exogamous union")+scale_y_log10()
g + geom_point(size=3)+mytheme+ylab("odds ratio of exogamous union")+scale_y_log10()
lOR <- data.frame(lOR=c(-7.82, lOR.wb,lOR.wr,lOR.br),
marriage=as.factor(c("USA\nWhite/Black","Brazil\nWhite/Black",
"Brazil\nWhite/Brown","Brazil\nBrown/Black")))
lOR
lOR <- data.frame(lOR=c(-7.82, lOR.wb,lOR.wr,lOR.br),
marriage=as.factor(c("USA\nWhite/Black","Brazil\nWhite/Black",
"Brazil\nWhite/Brown","Brazil\nBrown/Black")))
lOR$marriage <- relevel(lOR$marriage,"Brazil\nBrown/Black")
lOR$marriage <- relevel(lOR$marriage,"Brazil\nWhite/Brown")
lOR$marriage <- relevel(lOR$marriage,"Brazil\nWhite/Black")
lOR$marriage <- relevel(lOR$marriage,"USA\nWhite/Black")
lOR$OR <- exp(lOR$lOR)
g <- ggplot(lOR, aes(x=marriage, y=OR), stat=identity)
g + geom_point(size=3)+mytheme+ylab("odds ratio of exogamous union")+scale_y_log10()
data <- rbind(c(0.14,.105,.145,.067),
c(.019,.002,.054,-.041),
c(.035,.034,.068,.002),
c(.202,.16,.209,.116),
c(.117,.108,.124,.096),
c(.039,.025,.073,-.026),
c(.09,.076,.122,.028),
c(.094,.084,.102,.071),
c(.189,.143,.171,.113),
c(-.093,-.148,-.157,-.136),
c(.17,.132,.113,.144),
c(.088,.04,.07,.01))
colnames(data) <- c("Pooled","Geometric Mean", "Same as Lighter","Same as Darker")
secoef.wEB <- as.data.frame.table(data)
secoef.wEB$couple <- as.factor(rep(c("Black Man/White Woman","Black Man/White Woman","White Man/Black Woman", "White Man/Black Woman",
"Brown Man/White Woman", "Brown Man/White Woman", "White Man/Brown Woman", "White Man/Brown Woman",
"Black Man/Brown Woman", "Black Man/Brown Woman", "Brown Man/Black Woman", "Brown Man/Black Woman"),4))
secoef.wEB$parameter <- as.factor(rep(c("Lighter\nHypergamy","Lighter\nHypogamy"),8))
secoef.wEB$error <- c(0.054,0.055,0.063,0.063,0.022,0.022,0.024,0.024,0.057,0.059,0.073,0.074,
0.059,0.060,0.067,0.067,0.022,0.023,0.025,0.025,0.062,0.063,0.077,0.078,
0.054,0.055,0.063,0.063,0.023,0.023,0.025,0.025,0.058,0.060,0.074,0.075,
0.073,0.074,0.080,0.080,0.026,0.026,0.027,0.028,0.075,0.077,0.088,0.089)
colnames(secoef.wEB)[[2]] <- "Model"
colnames(secoef.wEB)[[3]] <- "Coefficient"
secoef.wEB$couple <- relevel(secoef.wEB$couple, "Brown Man/Black Woman")
secoef.wEB$couple <- relevel(secoef.wEB$couple, "White Man/Brown Woman")
secoef.wEB$couple <- relevel(secoef.wEB$couple, "White Man/Black Woman")
secoef.wEB$couple <- relevel(secoef.wEB$couple, "Black Man/Brown Woman")
secoef.wEB$couple <- relevel(secoef.wEB$couple, "Brown Man/White Woman")
secoef.wEB$couple <- relevel(secoef.wEB$couple, "Black Man/White Woman")
g <- ggplot(secoef.wEB, aes(x=parameter, fill=Model, y=Coefficient), stat="identity")
g + geom_bar(position="dodge") + facet_wrap(~couple) + scale_fill_grey()
secoef2 <- rbind(secoef,secoef.wEB)
secoef2$controls <- as.factor(c(rep("w/o Market Exchange Terms",48),rep("with Market Exchange Terms",48)))
secoefWB.cons <- rbind(summary(semodel4.wb)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE"),1:2],
summary(semodel4.wb.cons)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE"),1:2],
summary(ebmodel4.wb)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE"),1:2],
summary(ebmodel4.wb.cons)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE"),1:2])
secoefWB <- rbind(summary(semodel4.wb)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE"),1:2],
summary(ebmodel4.wb)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE"),1:2])
secoefWB
colnames(secoefWB) <- c("Coefficient","error")
rownames(secoefWB) <- NULL
secoefWB.cons <- as.data.frame(secoefWB)
secoefWB$couple <- as.factor(rep(c("Non-White Man/White Woman","Non-White Man/White Woman",
"White Man/Non-White Woman", "White Man/Non-White Woman")
,2))
secoefWB
secoefWB <- rbind(summary(semodel4.wb)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE"),1:2],
summary(ebmodel4.wb)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE"),1:2])
colnames(secoefWB) <- c("Coefficient","error")
rownames(secoefWB) <- NULL
secoefWB <- as.data.frame(secoefWB)
secoefWB$couple <- as.factor(rep(c("Non-White Man/White Woman","Non-White Man/White Woman",
"White Man/Non-White Woman", "White Man/Non-White Woman")
,2))
secoefWB
secoefWB.cons$parameter <- as.factor(rep(rep(c("White Hypergamy","White Hypogamy"),2),2))
secoefWB$parameter <- as.factor(rep(rep(c("White Hypergamy","White Hypogamy"),2),2))
secoefWB
secoefWB$controls <- as.factor(c(rep("w/o Market Exchange Terms",84,rep("with Market Exchange Terms",4)))
)
secoefWB$controls <- as.factor(c(rep("w/o Market Exchange Terms",4),rep("with Market Exchange Terms",4)))
secoefWB
g <- ggplot(secoefWB.cons, aes(parameter, Coefficient, shape=data, ymin = Coefficient-1.96*error, ymax=Coefficient+1.96*error))
g <- ggplot(secoefWB, aes(parameter, Coefficient, shape=data, ymin = Coefficient-1.96*error, ymax=Coefficient+1.96*error))
g + geom_point(size=4, position=position_dodge(width=0.5)) + geom_errorbar(width=0.1, position=position_dodge(width=0.5)) + facet_grid(controls~couple)+theme(panel.grid.major = element_line(colour = "NA",),panel.grid.minor = element_line(colour = NA),panel.background = element_rect(fill='white', colour = 'black'), legend.position="bottom")+geom_hline(aes(yintercept=0), linetype=2, colour="grey")+ scale_colour_grey()+ylab("log odds ratio of interracial marriage")
g <- ggplot(secoefWB, aes(parameter, Coefficient,
ymin = Coefficient-1.96*error, ymax=Coefficient+1.96*error))
g + geom_point(size=4, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(controls~couple)+
mytheme+
geom_hline(aes(yintercept=0), linetype=2, colour="grey")+
scale_colour_grey()+
ylab("log odds ratio of interracial marriage")
summary(ebmodel4.wb)$coef[16:31,1:2]
ebcoefWB <- summary(ebmodel4.wb)$coef[16:31,1:2]
colnames(ebcoefWB.cons) <- c("Coefficient","error")
colnames(ebcoefWB) <- c("Coefficient","error")
rownames(ebcoefWB) <- NULL
ebcoefWB <- as.data.frame(ebcoefWB)
ebcoefWB$race <- as.factor(c(rep("Non-White Man",4),rep("White Woman",4),rep("White Man",4),rep("Non-White Woman",4)))
ebcoefWB
ebcoefWB.cons$barrier <- as.factor(rep(c("Primary Grad v. Incomplete Primary", "Lower Secondary v. Primary Grad", "Upper Secondary v. Lower Secondary", "Some College v. Upper Secondary"), 4))
ebcoefWB$barrier <- as.factor(rep(c("Primary Grad v. Incomplete Primary", "Lower Secondary v. Primary Grad", "Upper Secondary v. Lower Secondary", "Some College v. Upper Secondary"), 4))
ebcoefWB
ebcoefWB$race <- relevel(ebcoefWB$race,"White Woman")
ebcoefWB$race <- relevel(ebcoefWB$race,"White Man")
ebcoefWB$race <- relevel(ebcoefWB$race,"Non-White Woman")
ebcoefWB$race <- relevel(ebcoefWB$race,"Non-White Man")
ebcoefWB$barrier <- relevel(ebcoefWB$barrier, "Some College v. Upper Secondary")
ebcoefWB$barrier <- relevel(ebcoefWB$barrier, "Upper Secondary v. Lower Secondary")
ebcoefWB$barrier <- relevel(ebcoefWB$barrier, "Lower Secondary v. Primary Grad")
ebcoefWB$barrier <- relevel(ebcoefWB$barrier, "Primary Grad v. Incomplete Primary")
g <- ggplot(ebcoefWB, aes(barrier, Coefficient,
ymin = Coefficient-1.96*error, ymax=Coefficient+1.96*error))
g + geom_point(size=3, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_wrap(~race)+geom_hline(aes(yintercept=0), linetype=2, colour="grey")+
scale_colour_grey()+
coord_flip()+
ylab("log odds ratio of interracial marriage")+
mytheme
summary(ebmodel4.full)$coef[26:73,1:2]
ebcoef <- summary(ebmodel4.full)$coef[26:73,1:2]
colnames(ebcoef) <- c("Coefficient","error")
rownames(ebcoef) <- NULL
ebcoef <- as.data.frema.table(ebcoef)
ebcoef <- as.data.frame.table(ebcoef)
ebcoef$couple <- as.factor(c(rep("White/Black",16),rep("Brown/Black",16),rep("White/Brown",16)))
ebcoef <- as.data.frame(ebcoef)
ebcoef$color <- as.factor(c(rep("Darker Man",4),rep("Lighter Woman",4), rep("Lighter Man",4),rep("Darker Woman",4),
ebcoef <- summary(ebmodel4.full)$coef[26:73,1:2]
colnames(ebcoef) <- c("Coefficient","error")
rownames(ebcoef) <- NULL
ebcoef <- as.data.frame.table(ebcoef)
ebcoef <- summary(ebmodel4.full)$coef[26:73,1:2]
colnames(ebcoef) <- c("Coefficient","error")
rownames(ebcoef) <- NULL
ebcoef <- as.data.frame.table(ebcoef)
ebcoef$couple <- as.factor(c(rep("White/Black",16),rep("Brown/Black",16),rep("White/Brown",16)))
ebcoef$color <- as.factor(c(rep("Darker Man",4),rep("Lighter Woman",4), rep("Lighter Man",4),rep("Darker Woman",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4)))
ebcoef$gender <- as.factor(c(rep("Male",4),rep("Female",4), rep("Male",4),rep("Female",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4)))
ebcoef$barrier <- as.factor(rep(c("Primary Grad v. Incomplete Primary", "Lower Secondary v. Primary Grad", "Upper Secondary v. Lower Secondary", "Some College v. Upper Secondary"), 12))
ebcoef$Model <- "Pooled"
ebcoef$barrier <- relevel(ebcoef$barrier, "Some College v. Upper Secondary")
ebcoef$barrier <- relevel(ebcoef$barrier, "Upper Secondary v. Lower Secondary")
ebcoef$barrier <- relevel(ebcoef$barrier, "Lower Secondary v. Primary Grad")
ebcoef$barrier <- relevel(ebcoef$barrier, "Primary Grad v. Incomplete Primary")
ebcoef$couple <- relevel(ebcoef$couple, "White/Brown")
ebcoef$couple <- relevel(ebcoef$couple, "White/Black")
ebcoef
g <- ggplot(ebcoef, aes(barrier, Coefficient, color=Model,
ymin = Coefficient-1.96*error, ymax=Coefficient+1.96*error))
g + geom_point(size=2, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(couple~color)+
geom_hline(aes(yintercept=0), linetype=2, colour="grey") +
scale_colour_grey()+
coord_flip()+
ylab("log odds ratio of interracial marriage") +
coord_flip()+
mytheme
ebcoef <- summary(ebmodel4.full)$coef[26:73,1:2]
ebcoef
rownames(ebcoef) <- NULL
colnames(ebcoef) <- c("Coefficient","error")
ebcoef <- summary(ebmodel4.full)$coef[26:73,1:2]
colnames(ebcoef) <- c("Coefficient","error")
rownames(ebcoef) <- NULL
ebcoef <- as.data.frame.table(ebcoef)
ebcoef
ebcoef <- summary(ebmodel4.full)$coef[26:73,1:2]
colnames(ebcoef) <- c("Coefficient","error")
rownames(ebcoef) <- NULL
ebcoef <- as.data.frame(ebcoef)
ebcoef$couple <- as.factor(c(rep("White/Black",16),rep("Brown/Black",16),rep("White/Brown",16)))
ebcoef$color <- as.factor(c(rep("Darker Man",4),rep("Lighter Woman",4), rep("Lighter Man",4),rep("Darker Woman",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4),
rep("Darker Man",4),rep("Lighter Woman",4), rep("Darker Woman",4),rep("Lighter Man",4)))
ebcoef$gender <- as.factor(c(rep("Male",4),rep("Female",4), rep("Male",4),rep("Female",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4),
rep("Male",4),rep("Female",4), rep("Female",4),rep("Male",4)))
ebcoef$barrier <- as.factor(rep(c("Primary Grad v. Incomplete Primary", "Lower Secondary v. Primary Grad", "Upper Secondary v. Lower Secondary", "Some College v. Upper Secondary"), 12))
ebcoef$Model <- "Pooled"
ebcoef$barrier <- relevel(ebcoef$barrier, "Some College v. Upper Secondary")
ebcoef$barrier <- relevel(ebcoef$barrier, "Upper Secondary v. Lower Secondary")
ebcoef$barrier <- relevel(ebcoef$barrier, "Lower Secondary v. Primary Grad")
ebcoef$barrier <- relevel(ebcoef$barrier, "Primary Grad v. Incomplete Primary")
ebcoef$couple <- relevel(ebcoef$couple, "White/Brown")
ebcoef$couple <- relevel(ebcoef$couple, "White/Black")
g <- ggplot(ebcoef, aes(barrier, Coefficient, color=Model,
ymin = Coefficient-1.96*error, ymax=Coefficient+1.96*error))
g + geom_point(size=2, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(couple~color)+
geom_hline(aes(yintercept=0), linetype=2, colour="grey") +
scale_colour_grey()+
coord_flip()+
ylab("log odds ratio of interracial marriage") +
coord_flip()+
mytheme
secoef <- rbind(summary(semodel4.full)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE",
"SERMWFUpTRUE","SERMWFDownTRUE","SEWMRFUpTRUE","SEWMRFDownTRUE",
"SEBMRFUpTRUE","SEBMRFDownTRUE","SERMBFUpTRUE","SERMBFDownTRUE"),
1:2],
summary(ebmodel4.full)$coef[c("SEBMWFUpTRUE","SEBMWFDownTRUE","SEWMBFUpTRUE","SEWMBFDownTRUE",
"SERMWFUpTRUE","SERMWFDownTRUE","SEWMRFUpTRUE","SEWMRFDownTRUE",
"SEBMRFUpTRUE","SEBMRFDownTRUE","SERMBFUpTRUE","SERMBFDownTRUE"),
1:2])
secoef
colnames(secoef) <- c("Coefficient","error")
rownames(secoef) <- NULL
secoef<- as.data.frame(secoef)
secoef$couple <- as.factor(rep(c("Black Man/White Woman","Black Man/White Woman","White Man/Black Woman", "White Man/Black Woman",
"Brown Man/White Woman", "Brown Man/White Woman", "White Man/Brown Woman", "White Man/Brown Woman",
"Black Man/Brown Woman", "Black Man/Brown Woman", "Brown Man/Black Woman", "Brown Man/Black Woman"),4))
secoef$couple <- as.factor(rep(c("Black Man/White Woman","Black Man/White Woman","White Man/Black Woman", "White Man/Black Woman",
"Brown Man/White Woman", "Brown Man/White Woman", "White Man/Brown Woman", "White Man/Brown Woman",
"Black Man/Brown Woman", "Black Man/Brown Woman", "Brown Man/Black Woman", "Brown Man/Black Woman"),2))
secoefFull.cons$parameter <- as.factor(rep(c("Lighter\nHypergamy","Lighter\nHypogamy"),12))
secoef$parameter <- as.factor(rep(c("Lighter\nHypergamy","Lighter\nHypogamy"),12))
secoef$controls <- as.factor(c(rep("w/o Market Exchange Terms",24),rep("with Market Exchange Terms",12)))
secoef$controls <- as.factor(c(rep("w/o Market Exchange Terms",12),rep("with Market Exchange Terms",12)))
secoef
secoefFull.cons$couple <- relevel(secoefFull.cons$couple, "Brown Man/Black Woman")
secoefFull.cons$couple <- relevel(secoefFull.cons$couple, "White Man/Brown Woman")
secoef$couple <- relevel(secoef$couple, "Brown Man/Black Woman")
secoef$couple <- relevel(secoef$couple, "White Man/Brown Woman")
secoef$couple <- relevel(secoef$couple, "White Man/Black Woman")
secoef$couple <- relevel(secoef$couple, "Black Man/Brown Woman")
secoef$couple <- relevel(secoef$couple, "Brown Man/White Woman")
secoef$couple <- relevel(secoef$couple, "Black Man/White Woman")
g <- ggplot(secoef, aes(parameter, Coefficient,
ymin = Coefficient-1.96*error, ymax=Coefficient+1.96*error))
g + geom_point(size=4, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(controls~couple)+
geom_hline(aes(yintercept=0), linetype=2, colour="grey")+
scale_color_grey()+xlab("")+
ylab("log odds ratio of interracial marriage")+
mytheme
g <- ggplot(secoef, aes(parameter, Coefficient,
ymin = Coefficient-1.96*error, ymax=Coefficient+1.96*error))
g + geom_point(size=3, position=position_dodge(width=0.5)) +
geom_errorbar(width=0.1, position=position_dodge(width=0.5)) +
facet_grid(controls~couple)+
geom_hline(aes(yintercept=0), linetype=2, colour="grey")+
scale_color_grey()+xlab("")+
ylab("log odds ratio of interracial marriage")+
mytheme
BIC <-
data.frame(groups=as.factor(c(rep("White and non-White",4), rep("White, Brown, and Black", 4))),
model=as.factor(rep(c("Baseline Model", "+Dyadic Exchange", "+Market Exchange", "+Dyadic Exchange\n+Market Exchange"),2)),
BIC=c(4053, 1371, -182, -233, 3069, 357, -1098, -1073))
BIC$model <- relevel(BIC$model,"+Dyadic Exchange\n+Market Exchange")
BIC$model <- relevel(BIC$model,"+Market Exchange")
BIC$model <- relevel(BIC$model,"+Dyadic Exchange")
BIC$model <- relevel(BIC$model,"Baseline Model")
adjust <- c(rep(-0.1,4),rep(1.1,4))
g <- ggplot(BIC, aes(x=model, fill=groups, y=BIC))
g + geom_bar(position="dodge")+xlab("")+scale_fill_grey()+theme(panel.grid.major = element_line(colour = "NA",size=0),panel.grid.minor = element_line(colour = NA, size=0),panel.background = element_rect(colour = 'black', fill='white'), legend.position="bottom")+geom_text(aes(x=model,y=BIC,label=paste(BIC)), position=position_dodge(width=1), vjust=adjust)
BIC
g + geom_bar(position="dodge")
g + geom_bar()
?knitr
library(knitr)
?knitr
BIC
g + geom_bar(
)
g + geom_bar(stat="identity", position="dodge")+xlab("")+scale_fill_grey()+theme(panel.grid.major = element_line(colour = "NA",size=0),panel.grid.minor = element_line(colour = NA, size=0),panel.background = element_rect(colour = 'black', fill='white'), legend.position="bottom")+geom_text(aes(x=model,y=BIC,label=paste(BIC)), position=position_dodge(width=1), vjust=adjust)
get.bic <- function(model) {
return(model$deviance - (model$df.residual * log(sum(model$fitted.values)+sum(model$residuals))))
}
get.bic0 <- function(model) {
return((model$deviance-model$null.deviance) + (model$df.null - model$df.residual) * log(sum(model$fitted.values)+sum(model$residuals)))
}
get.bic(basemodel.wb)
get.bic(basemodel4.wb)
get.bic(semodel4.wb)
get.bic(ebmodel4.wb)
get.bic(ebomodel4.wb)
?lapply
lapply(list(basemodel4.wb, semodel4.wb, ebomodel4.wb, ebmodel4.wb,
basemodel4.full, semodel4.full, ebomodel4.full, ebmodel4.full),
get.bic)
x <- lapply(list(basemodel4.wb, semodel4.wb, ebomodel4.wb, ebmodel4.wb,
basemodel4.full, semodel4.full, ebomodel4.full, ebmodel4.full),
get.bic)
x
as.numeric(x)
lapply(list(basemodel4.wb, semodel4.wb, ebomodel4.wb, ebmodel4.wb,
basemodel4.full, semodel4.full, ebomodel4.full, ebmodel4.full),
get.bic, simplify=TRUE)
lapply(list(basemodel4.wb, semodel4.wb, ebomodel4.wb, ebmodel4.wb,
basemodel4.full, semodel4.full, ebomodel4.full, ebmodel4.full),
get.bic, higher=FALSE)
BIC <-  data.frame(groups=as.factor(c(rep("White and non-White",4), rep("White, Brown, and Black", 4))),
model=as.factor(rep(c("Baseline Model", "+Dyadic Exchange", "+Market Exchange",
"+Dyadic Exchange\n+Market Exchange"),2)),
BIC=as.numeric(lapply(list(basemodel4.wb, semodel4.wb, ebomodel4.wb, ebmodel4.wb,
basemodel4.full, semodel4.full, ebomodel4.full, ebmodel4.full),
get.bic)))
BIC
BIC$model <- relevel(BIC$model,"+Dyadic Exchange\n+Market Exchange")
BIC$model <- relevel(BIC$model,"+Market Exchange")
BIC$model <- relevel(BIC$model,"+Dyadic Exchange")
BIC$model <- relevel(BIC$model,"Baseline Model")
adjust <- c(rep(-0.1,4),rep(1.1,4))
g <- ggplot(BIC, aes(x=model, fill=groups, y=BIC))
g + geom_bar(stat="identity", position="dodge")+xlab("")+scale_fill_grey()+theme(panel.grid.major = element_line(colour = "NA",size=0),panel.grid.minor = element_line(colour = NA, size=0),panel.background = element_rect(colour = 'black', fill='white'), legend.position="bottom")+geom_text(aes(x=model,y=BIC,label=paste(BIC)), position=position_dodge(width=1), vjust=adjust)
BIC <-  data.frame(groups=as.factor(c(rep("White and non-White",4), rep("White, Brown, and Black", 4))),
model=as.factor(rep(c("Baseline Model", "+Dyadic Exchange", "+Market Exchange",
"+Dyadic Exchange\n+Market Exchange"),2)),
BIC=as.numeric(lapply(list(basemodel4.wb, semodel4.wb, ebomodel4.wb, ebmodel4.wb,
basemodel4.full, semodel4.full, ebomodel4.full, ebmodel4.full),
get.bic)))
BIC$model <- relevel(BIC$model,"+Dyadic Exchange\n+Market Exchange")
BIC$model <- relevel(BIC$model,"+Market Exchange")
BIC$model <- relevel(BIC$model,"+Dyadic Exchange")
BIC$model <- relevel(BIC$model,"Baseline Model")
BIC$BIC <- round(BIC$BIC, 0)
adjust <- c(rep(-0.1,4),rep(1.1,4))
g <- ggplot(BIC, aes(x=model, fill=groups, y=BIC))
g + geom_bar(stat="identity", position="dodge")+xlab("")+scale_fill_grey()+theme(panel.grid.major = element_line(colour = "NA",size=0),panel.grid.minor = element_line(colour = NA, size=0),panel.background = element_rect(colour = 'black', fill='white'), legend.position="bottom")+geom_text(aes(x=model,y=BIC,label=paste(BIC)), position=position_dodge(width=1), vjust=adjust)
g + geom_bar(stat="identity", position="dodge")+
xlab("")+
scale_fill_grey()+
geom_text(aes(x=model,y=BIC,label=paste(BIC)), position=position_dodge(width=1), vjust=adjust)+
mytheme
g + geom_bar(stat="identity", position="dodge")+
xlab("")+
scale_fill_grey()+
geom_text(aes(x=model,y=BIC,label=paste(BIC)), position=position_dodge(width=1), vjust=adjust)+
theme(panel.grid.major = element_line(colour = "NA",size=0),panel.grid.minor = element_line(colour = NA, size=0),panel.background = element_rect(colour = 'black', fill='white'), legend.position="bottom")
g + geom_bar(stat="identity", position="dodge")+
xlab("")+
scale_fill_grey()+
geom_text(aes(x=model,y=BIC,label=paste(BIC)), position=position_dodge(width=1), vjust=adjust)+
mytheme+
theme(legend.position="bottom")
source('~/Research/Github_reps/brazil_intermar/figures.R', echo=TRUE)
g <- ggplot(lOR, aes(x=marriage, y=OR), stat=identity)
g + geom_point(size=3)+theme(panel.grid.major = element_line(colour = "NA",),panel.grid.minor = element_line(colour = NA),panel.background = element_rect(fill='white', colour = 'black'),legend.position = "none")+ylab("odds ratio of exogamous union")+scale_y_log10()
g + geom_point(size=3)+
mytheme+
ylab("odds ratio of exogamous union")+
scale_y_log10()
g + geom_point(size=3)+
theme(panel.grid.major = element_line(colour = "NA",),panel.grid.minor = element_line(colour = NA),panel.background = element_rect(fill='white', colour = 'black'),legend.position = "none")+
ylab("odds ratio of exogamous union")+scale_y_log10()
g <- ggplot(lOR, aes(x=marriage, y=OR), stat=identity)
g + geom_point(size=3)+
theme(panel.grid.major = element_line(colour = "NA"),panel.grid.minor = element_line(colour = NA),panel.background = element_rect(fill='white', colour = 'black'),legend.position = "none")+
ylab("odds ratio of exogamous union")+scale_y_log10()
g + geom_point(size=3)+
# theme(panel.grid.major = element_line(colour = "NA"),panel.grid.minor = element_line(colour = NA),panel.background = element_rect(fill='white', colour = 'black'),legend.position = "none")+
mytheme+
ylab("odds ratio of exogamous union")+scale_y_log10()
g + geom_point(size=3)+
mytheme+
ylab("odds ratio of exogamous union")+
scale_y_log10()
knit("figures.Rmd")
